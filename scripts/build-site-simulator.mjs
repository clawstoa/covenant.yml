#!/usr/bin/env node
import fs from "node:fs";
import path from "node:path";

const repoRoot = process.cwd();
const sourcePath = path.join(repoRoot, "src/simulator/browser-entry.js");
const outPath = path.join(repoRoot, "site/simulator.bundle.js");

if (!fs.existsSync(sourcePath)) {
  throw new Error(`Missing source file: ${sourcePath}`);
}

const source = fs.readFileSync(sourcePath, "utf8");
const banner = [
  "/*",
  " * Generated by scripts/build-site-simulator.mjs",
  ` * Source: src/simulator/browser-entry.js`,
  ` * Built: ${new Date().toISOString()}`,
  " */",
  "",
].join("\n");

fs.writeFileSync(outPath, `${banner}${source}`);
process.stdout.write(`Wrote ${path.relative(repoRoot, outPath)}\n`);

